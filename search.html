<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Wempe Artikel Viewer</title>
<style>
  body {
    margin: 0;
    font-family: system-ui, Arial, sans-serif;
    background: #f5f5f5;
  }
  header {
    position: fixed;
    top: 0; left: 0; right: 0;
    background: #111;
    color: #fff;
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    z-index: 9999;
  }
  header input {
    flex: 1;
    padding: 8px;
    border-radius: 4px;
    border: none;
  }
  header button {
    padding: 8px 16px;
    border-radius: 4px;
    border: none;
    background: #444;
    color: #fff;
    cursor: pointer;
  }
  #frame {
    position: fixed;
    top: 56px;
    left: 0; right: 0;
    bottom: 0;
    width: 100%;
    border: none;
  }
  #blocked {
    margin-top: 80px;
    text-align: center;
    padding: 20px;
    color: #c00;
    display: none;
  }
</style>
</head>
<body>

<header>
  <input id="art" placeholder="Artikelnummer eingeben…" autofocus />
  <button id="go">Öffnen</button>
</header>

<iframe id="frame"></iframe>

<div id="blocked">
  ⚠️ Einbetten wurde blockiert.<br>
  <a id="fallback" href="#" target="_blank" rel="noopener">Seite in neuem Tab öffnen</a>
</div>

<script>
function loadSearch() {
  const art = document.getElementById("art").value.trim();
  if (!art) return;

  const url = "https://www.wempe.com/de-de/search?sSearch=" + encodeURIComponent(art);
  const frame = document.getElementById("frame");
  frame.style.display = "block";
  frame.src = url;

  document.getElementById("blocked").style.display = "none";
}

document.getElementById("go").onclick = loadSearch;
document.getElementById("art").addEventListener("keydown", e => {
  if (e.key === "Enter") loadSearch();
});

// Block-Erkennung
document.getElementById("frame").addEventListener("load", () => {
  const notice = document.getElementById("blocked");
  try {
    // cross-origin Zugriff testen → wenn exception: blockiert
    const doc = frame.contentWindow.document;
    console.log("Iframe geladen.");
  } catch(e) {
    // blockiert
    document.getElementById("frame").style.display = "none";
    notice.style.display = "block";
    document.getElementById("fallback").href = frame.src;
  }
});
</script>

</body>
</html>
